import pandas as pd
from sklearn import neighbors
from sklearn.externals import joblib
import os



dir="D:\ML"
train=pd.read_csv(os.path.join(dir,"Iris.csv"))
print(train.info())

features=['SepalLengthCm','SepalWidthCm','PetalLengthCm','PetalWidthCm']
X_train=train[features]
y_train=train['Species']



knn_estimator=neighbors.KNeighborsClassifier()


scores=model_selection.cross_validate(knn_estimator,X_train,y_train,cv=10)
print(scores.get('test_score').mean())
grid={'weights':['uniform','distance'],'n_neighbors':[5,10,20]}
final_estimator=model_selection.GridSearchCV(knn_estimator,grid,cv=10)
final_estimator.fit(X_train,y_train)
print(final_estimator.best_score_)
print(final_estimator.best_params_)
results=final_estimator.cv_results_
print(results.get('mean_test_score').mean())
print(results.get('mean_train_score').mean())


objects_to_dump={'features':features,'knn_estimator':final_estimator}



joblib.dump(objects_to_dump, os.path.join(dir, 'deployment.pkl') )

