#knn_model deployment

import pandas as pd
from flask import Flask, jsonify, request
from sklearn.externals import joblib
import os
app = Flask("titanic_ml_service")

@app.route('/predict/', methods=['POST'])

def predict():
    data = request.json
    print("in service")
    print(data)
    titanic_test = pd.DataFrame(data)
    print(titanic_test.info())
    features=objects.get('features')
    X_test=titanic_test[features]
    print(X_test)
    knn_estimator=objects.get('knn_estimator')
    pred=knn_estimator.predict(X_test)
    return jsonify(pred=str(pred))
    
    
    
    
if __name__ == '__main__':
    dir = "D:\ML"
    objects = joblib.load( os.path.join(dir, 'deployment.pkl') )
    app.run(port=8080)
